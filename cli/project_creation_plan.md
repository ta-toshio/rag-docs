# Project Creation Plan

**1. プロジェクト作成のトリガー:**

*   プロジェクトの作成プロセスは、`url`または`input`コマンドが実行されたときに暗黙的にトリガーされます。

**2. CLIコマンドの構造:**

*   `url`および`input`コマンドは、現在の構造を維持します。

**3. プロジェクト作成プロセス:**

1.  **プロジェクトが存在するか確認:**
    *   `url`または`input`コマンドが実行されたときに、指定されたURLまたは入力値（ファイルパスなど）を`value`として持つプロジェクトが`projects`テーブルにすでに存在するかどうかを確認します。
2.  **プロジェクトエントリを作成（必要な場合）:**
    *   プロジェクトが存在しない場合は、プロジェクトの一意のIDを生成し、指定されたURLまたは入力値を`value`、生成されたID、および現在のタイムスタンプを使用して、`projects`テーブルに新しいエントリを作成します。
3.  **データをプロジェクトに関連付ける:**
    *   クローリングまたはファイル処理時に、生成されたデータ（ファイルツリーエントリ）をプロジェクトに関連付けます。これを行うには、`file_trees`テーブルにプロジェクトのIDを保存します。

**4. コードの変更:**

*   **`src/cli.ts`:**
    *   `url`および`input`コマンドの実行時に、プロジェクトが存在するかどうかを確認し、必要に応じて作成するロジックを実装します。
    *   プロジェクトIDをファイルツリーハンドラーに渡し、データをプロジェクトに関連付けることができるようにします。
*   **`src/databaseConnection.ts`:**
    *   SQLiteデータベースが初期化されるときに、`projects`テーブルが作成されるようにします。
*   **新しいファイル: `src/repository/projectRepository.ts`:**
    *   プロジェクト関連のデータベース操作（プロジェクトの作成、取得など）を処理するための新しいリポジトリを作成します。
*   **`src/repository/fileTreeRepository.ts`:**
    *   `upsertFileTreeEntry`関数を修正して`project_id`を受け入れ、`file_trees`テーブルに保存します。
*   **`src/domain/fileTreeEntry.ts`:**
    *   `FileTreeEntry`インターフェースを修正して`project_id`を含めます。

**5. エラー処理:**

*   無効な入力およびデータベースエラーに対するエラー処理を実装します。
*   エラーをコンソールおよびログファイルに記録します。