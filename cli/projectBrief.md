
# **要件定義書**

## **1. 基本情報**

- **プロジェクト名称**: Webドキュメント翻訳・要約・検索システム
- **リポジトリ名**: `doc-translator`
- **開発言語**: TypeScript
- **フレームワーク**:
    - **CLI**: Node.js
    - **Webアプリ**: Next.js
    - **データ管理**: Qdrant

---

## **2. プロジェクト概要**

本プロジェクトは、Web上に公開されている **公式ドキュメントを翻訳・要約し、検索可能な形で管理するシステム** を提供する。  
CLI ツールを使用してドキュメントを収集・翻訳を行う。

### **主な機能**

- **CLI によるドキュメント探索・翻訳・要約**
- **Qdrant によるベクトル検索**
- **Google Gemini API を活用した翻訳・要約・RAG検索**
- **ローカルフォルダ内のファイル処理（`input/` フォルダ対応）**

---

## **3. 機能要件**

### **3.1 CLI ツール (`translate-docs`)**

#### **📌 Webコンテンツの処理 (`--url`)**

- **指定 URL のドキュメントを解析し、指定の階層まで探索**
- **Markdown 形式で内容を保存**
- **Google Gemini API を使用して翻訳**
- **Google Gemini API を使用して要約**
- **出力フォルダ構成**
    
    ```plaintext
    output/
      sample.com/         # 対象ドメイン名
        markdown/         # オリジナルのMarkdown
        translation/      # 翻訳済みデータ
        summary/          # 要約データ
    ```
    

#### **📌 ローカルファイルの処理 (`--input`)**

- **プロジェクトルートの `input/` フォルダ内のファイルを処理**
- **フォルダ構造を保持**
- **翻訳・要約を適用**
- **出力フォルダ構成**
    
    ```plaintext
    output/
      input/              # ローカルの `input/` の処理結果
        markdown/         # オリジナルのMarkdown
        translation/      # 翻訳済みデータ
        summary/          # 要約データ
    ```
    

#### **📌 CLI オプション**

|オプション|説明|デフォルト|
|---|---|---|
|`--url <URL>`|解析対象のURL（Web）|**必須（`--input` と併用不可）**|
|`--input`|ローカルの `input/` フォルダ内のファイルを処理|**必須（`--url` と併用不可）**|
|`--depth <number>`|探索の深さ（Webの場合）|`3`|
|`--language <lang>`|翻訳言語|`ja`|
|`--summary-only`|要約のみ実行|`false`|
|`--translate-only`|翻訳のみ実行|`false`|
|`--allow-domains <domains>`|許可ドメインの指定|`なし`|

---


## **4. 非機能要件**

### **4.1 パフォーマンス**

- **CLI の並列処理を実装**（Gemini API のレートリミットを考慮）
- **Qdrant を使用した高速なベクトル検索**

### **4.2 セキュリティ**

- **API キーの環境変数管理**

### **4.3 運用・保守**

- **ログ出力（CLIのエラーハンドリング）**
- **エラーハンドリング（リトライ・バックオフの実装）**
- **環境変数で設定を管理（翻訳対象言語, API キー, 許可ドメイン）**

---

## **5. 制約条件**

- **Google Gemini API の利用制限**
    - 1分間に **15リクエストまで**
- **Qdrant を Docker でローカル環境に構築**
- **検索は基本的に Web UI で行い、CLI からは直接検索しない**
- **CLI の `--url` オプションは必須**
- **シンタックスハイライトは行わない**

---

## **6. 開発環境**

|項目|技術スタック|
|---|---|
|**言語**|TypeScript|
|**CLI 実行環境**|Node.js|
|**データベース**|**Qdrant**|
|**埋め込みモデル**|Google Gemini API|
|**検索エンジン**|Qdrant|
|**ベクトル検索**|Qdrant（Docker）|

---

## **7. 成果物**

- **CLI ツール (`translate-docs`)**
- **Qdrant による検索機能**
- **要件定義書・設計書**
- **セットアップ用 README**
